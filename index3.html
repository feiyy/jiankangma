<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<script type="text/javascript" src="https://api.map.baidu.com/api?v=2.0&ak=Df5kztZ3rOcLOonFN1rudtIxm6buhcdA"></script>
	</head>
	<body>
		
		<script>
			
			navigator.geolocation.getCurrentPosition((position) => {
			    let lat = position.coords.latitude;
			    let lng = position.coords.longitude;
				
			    const pointBak = new BMap.Point(lng, lat);
			    const convertor = new BMap.Convertor();
			    convertor.translate([pointBak], 1, 5,function(resPoint) {
			        if(resPoint && resPoint.points && resPoint.points.length>0){

			            lng = resPoint.points[0].lng;
			            lat = resPoint.points[0].lat;
			        }
			        const point = new BMap.Point(lng, lat);
			        const geo = new BMap.Geocoder();
					
			        geo.getLocation(point, (res) => {
						
						alert(JSON.stringify(res));
						var addComp = res.surroundingPois;
						alert(JSON.stringify(addComp));
						alert(addComp[0].title);
						
						
						var arrstr = sessionStorage.getItem("arrstr");
						var arr;
						if(arrstr)
						{
							arr = JSON.parse(arrstr);
						}
						else
						{
							arr = [];
						}
						
						var obj = {};						
						obj.stime = new Date;
						obj.place = addComp[0].title;
						arr.push(obj);
						
						sessionStorage.setItem("arrstr",JSON.stringify(arr));

			        });
			    });
			});
			
			
			
			
			
		</script>
	</body>
</html>
